<!DOCTYPE html><html lang="zh-TW"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>SLMT's Blog | Rust-PTT 開發筆記 1</title><link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/blog/css/style.css"><link rel="stylesheet" type="text/css" href="/blog/css/syntax-highlight.css"><script src="https://use.fontawesome.com/0bc11e7eba.js"></script><!-- Open Graph Protocol--><meta property="og:title" content="Rust-PTT 開發筆記 1"><meta property="og:image" content="http://www.slmt.tw/images/logo.png"><meta property="og:type" content="website"><meta property="og:url" content="/blog/2016/08/13/rust-ptt-notes-1/"><meta property="og:site_name" content="SLMT's Blog"><meta property="og:locale" content="zh-TW"><meta property="og:description" content="很早以前我就想深入研究 PTT 的程式碼，雖然 PTT 很早就將程式碼開源出來，但是當時我並沒有能力看懂。最近又將程式碼翻出來看，看了一些之後有些心得。剛好在 PTT 上有人在討論重寫 PTT 的問題，因此就讓我起了重寫 PTT 的意思。
這裡我選擇使用 Rust 做為重寫的語言。主要是因為我最近在研究這個程式語言，但是一直沒有甚麼機會寫出比較大的專案。因此我認為用 Rust 寫 PTT 剛好是個不錯的機會，於是這個專案就這麼開始了！
從這裡可以到 Rust-PTT 的 Github 頁面：https://github.com/SLMT/rust-ptt/"></head><body><div id="container"><div id="header"><h1 class="title">SLMT's Blog</h1><div class="pure-g navs"><div class="nav pure-u-1 pure-u-sm-1-4"><a href="/blog/.">Home</a></div><div class="nav pure-u-1 pure-u-sm-1-4"><a href="/blog/archives">Archive</a></div><div class="nav pure-u-1 pure-u-sm-1-4"><a href="/blog/about">About</a></div><div class="nav pure-u-1 pure-u-sm-1-4"><a href="/blog/rss.xml">RSS</a></div></div></div><div id="main"><h1 class="post-large-title">Rust-PTT 開發筆記 1</h1><div class="post-meta"><div class="post-date"><i class="fa fa-calendar" aria-hidden="true"></i>2016/08/13</div><div class="post-cats"><i class="fa fa-folder-open" aria-hidden="true"></i><a class="post-cat" href="/blog/categories/project/">Project</a>/<a class="post-cat" href="/blog/categories/project/rust-ptt/">Rust-PTT</a></div><div class="post-tags"><i class="fa fa-tags" aria-hidden="true"></i><a class="post-tag" href="/blog/tags/rust/">#rust</a><a class="post-tag" href="/blog/tags/code/">#code</a><a class="post-tag" href="/blog/tags/ptt/">#ptt</a><a class="post-tag" href="/blog/tags/bbs/">#bbs</a><a class="post-tag" href="/blog/tags/project/">#project</a></div></div><div class="post-content"><p>很早以前我就想深入研究 PTT 的程式碼，雖然 PTT 很早就將程式碼開源出來，但是當時我並沒有能力看懂。最近又將程式碼翻出來看，看了一些之後有些心得。剛好在 PTT 上有人在<a href="https://github.com/ptt/pttbbs/issues/5" target="_blank" rel="external">討論重寫 PTT</a> 的問題，因此就讓我起了重寫 PTT 的意思。</p>
<p>這裡我選擇使用 Rust 做為重寫的語言。主要是因為我最近在研究這個程式語言，但是一直沒有甚麼機會寫出比較大的專案。因此我認為用 Rust 寫 PTT 剛好是個不錯的機會，於是這個專案就這麼開始了！</p>
<p>從這裡可以到 Rust-PTT 的 Github 頁面：<a href="https://github.com/SLMT/rust-ptt/" target="_blank" rel="external">https://github.com/SLMT/rust-ptt/</a></p>
<a id="more"></a>
<h2 id="為什麼選擇-Rust"><a href="#為什麼選擇-Rust" class="headerlink" title="為什麼選擇 Rust"></a>為什麼選擇 Rust</h2><p><a href="https://www.rust-lang.org/en-US/" target="_blank" rel="external">Rust</a> 是很新的程式語言，去年 (2015) 5 月 16 號才釋出 1.0 正式版。最近也才剛進到 1.10.0 而已。很多東西都還在討論之中，但是大多數的東西應該都差不多定型了。</p>
<p>Rust 語言具有不會有 Segmentation Falut、不需自己管理記憶體 (但是也不用 Garbage Collection 等方式降低執行效能)、近似於 C 效能等特性。同時該語言融合了許多近期新興語言的特色，像是 Pattern Matching、Closures、Generics 等等，並且在於 Concurrency 的方面具有許多 Native Support。我認為 Rust 很適合用來開發大量用戶同時連線的 PTT，而且相較於 C 更容易維護。</p>
<p>Rust 語言目前由 Mozilla 公司開發維護，並且正以 Rust 與開發 Firefox 的經驗，重新撰寫<a href="https://github.com/servo/servo" target="_blank" rel="external">新的瀏覽器核心</a>。現在也有其它專案正在重新以 Rust 替換掉原本以 C 撰寫的程式。</p>
<h2 id="近期進度"><a href="#近期進度" class="headerlink" title="近期進度"></a>近期進度</h2><p>撰寫這篇文章的同時，我已經 commit 了 8 個版本。目前最新的版本為 <a href="https://github.com/SLMT/rust-ptt/commit/a63e83012f479ceea13b01fcdd037ae56ce857f5" target="_blank" rel="external">a63e830</a>。</p>
<p>一開始只有 Hello World，八個版本後已經有一個基本的 TCP Server，並且會對 Telnet Protocol 做一些初始化的動作。若一個 telnet client 嘗試連上目前的 server，在進行 telnet 初始化之後，server 會知道 client 需要多大的 terminal size。</p>
<p>目前 telnet 的實作主要是根據 PTT 內的實作方式進行，詳情可以參考我撰寫的另一篇文章：<a href="http://www.slmt.tw/2016/08/07/tracing-ptt-note-2/">PTT Source Code 研究筆記 2</a>。</p>
<h2 id="嘗試看看"><a href="#嘗試看看" class="headerlink" title="嘗試看看"></a>嘗試看看</h2><p>假設你的電腦已經安裝好 Rust 與 Git，你可透過在 shell 輸入下列指令啟動 rust-ptt 的 server：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; git clone https://github.com/SLMT/rust-ptt</div><div class="line">&gt; cd rust-ptt</div><div class="line">&gt; cargo run</div></pre></td></tr></table></figure>
<p>之後啟動都只要執行最後一個指令即可。</p>
<p>然後隨便找一個拿來連 PTT 的 client 或者 telnet client 來連上 server (網址：<code>localhost:54321</code>)，此時 server 這邊應該會顯示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Start a connection to 127.0.0.1:4229</div><div class="line">Width: 80, Height: 24</div></pre></td></tr></table></figure>
<p>第一行是 client 的資訊，第二行是 client 要求的 terminal 大小。目前只能顯示這些東西而已，client 則還不會看到任何結果。</p>
<h2 id="近期目標"><a href="#近期目標" class="headerlink" title="近期目標"></a>近期目標</h2><p>接下來應該會朝向完成基本的 terminal 功能，以及登入功能為主。</p>
</div><div id="disqus_thread"><script>var disqus_shortname = 'slmtsblog';
var disqus_identifier = '2016/08/13/rust-ptt-notes-1/';
var disqus_title = 'Rust-PTT 開發筆記 1';
var disqus_url = 'http://www.slmt.tw/blog/2016/08/13/rust-ptt-notes-1/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//#{theme.disqus}.disqus.com/count.js" async></script></div></div><div id="footer"><p>&copy; Yu-shan Lin (SLMT) and SLMT's Blog, 2016</p></div></div></body></html>